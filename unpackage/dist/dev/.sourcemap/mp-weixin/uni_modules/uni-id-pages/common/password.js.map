{"version":3,"file":"password.js","sources":["uni_modules/uni-id-pages/common/password.js"],"sourcesContent":["// 导入配置\r\nimport config from '@/uni_modules/uni-id-pages/config.js'\n\nconst {passwordStrength} = config\n\n// 密码强度表达式\r\nconst passwordRules = {\r\n\t// 密码必须包含大小写字母、数字和特殊符号\r\n\tsuper: /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/])[0-9a-zA-Z~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/]{8,16}$/,\r\n\t// 密码必须包含字母、数字和特殊符号\r\n\tstrong: /^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/])[0-9a-zA-Z~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/]{8,16}$/,\r\n\t// 密码必须为字母、数字和特殊符号任意两种的组合\r\n\tmedium: /^(?![0-9]+$)(?![a-zA-Z]+$)(?![~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/]+$)[0-9a-zA-Z~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/]{8,16}$/,\r\n\t// 密码必须包含字母和数字\r\n\tweak: /^(?=.*[0-9])(?=.*[a-zA-Z])[0-9a-zA-Z~!@#$%^&*_\\-+=`|\\\\(){}[\\]:;\"'<>,.?/]{6,16}$/\r\n}\r\n\r\nconst ERROR = {\r\n\tnormal: {\r\n\t\tnoPwd: '请输入密码',\r\n\t\tnoRePwd: '再次输入密码',\r\n\t\trePwdErr: '两次输入密码不一致'\r\n\t},\r\n\tpasswordStrengthError: {\r\n\t\tsuper: '密码必须包含大小写字母、数字和特殊符号，密码长度必须在8-16位之间',\r\n\t\tstrong: '密码必须包含字母、数字和特殊符号，密码长度必须在8-16位之间',\r\n\t\tmedium: '密码必须为字母、数字和特殊符号任意两种的组合，密码长度必须在8-16位之间',\r\n\t\tweak: '密码必须包含字母，密码长度必须在6-16位之间'\r\n\t}\r\n}\r\n\r\nfunction validPwd(password) {\r\n\t//强度校验\r\n\tif (passwordStrength && passwordRules[passwordStrength]) {\r\n\t\tif (!new RegExp(passwordRules[passwordStrength]).test(password)) {\r\n\t\t\treturn ERROR.passwordStrengthError[passwordStrength]\r\n\t\t}\r\n\t}\r\n\treturn true\r\n}\r\n\r\nfunction getPwdRules(pwdName = 'password', rePwdName = 'password2') {\r\n\tconst rules = {}\r\n\trules[pwdName] = {\r\n\t\trules: [{\r\n\t\t\t\trequired: true,\r\n\t\t\t\terrorMessage: ERROR.normal.noPwd,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalidateFunction: function(rule, value, data, callback) {\r\n\t\t\t\t\tconst checkRes = validPwd(value)\r\n\t\t\t\t\tif (checkRes !== true) {\r\n\t\t\t\t\t\tcallback(checkRes)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\r\n\tif (rePwdName) {\r\n\t\trules[rePwdName] = {\r\n\t\t\trules: [{\r\n\t\t\t\t\trequired: true,\r\n\t\t\t\t\terrorMessage: ERROR.normal.noRePwd,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tvalidateFunction: function(rule, value, data, callback) {\r\n\t\t\t\t\t\tif (value != data[pwdName]) {\r\n\t\t\t\t\t\t\tcallback(ERROR.normal.rePwdErr)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t}\r\n\treturn rules\r\n}\r\n\r\nexport default {\r\n\tERROR,\r\n\tvalidPwd,\r\n\tgetPwdRules\r\n}\n"],"names":["config"],"mappings":";;AAGA,MAAM,EAAC,iBAAgB,IAAIA,8BAAM;AAGjC,MAAM,gBAAgB;AAAA;AAAA,EAErB,OAAO;AAAA;AAAA,EAEP,QAAQ;AAAA;AAAA,EAER,QAAQ;AAAA;AAAA,EAER,MAAM;AACP;AAEA,MAAM,QAAQ;AAAA,EACb,QAAQ;AAAA,IACP,OAAO;AAAA,IACP,SAAS;AAAA,IACT,UAAU;AAAA,EACV;AAAA,EACD,uBAAuB;AAAA,IACtB,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,MAAM;AAAA,EACN;AACF;AAEA,SAAS,SAAS,UAAU;AAE3B,MAAI,oBAAoB,cAAc,gBAAgB,GAAG;AACxD,QAAI,CAAC,IAAI,OAAO,cAAc,gBAAgB,CAAC,EAAE,KAAK,QAAQ,GAAG;AAChE,aAAO,MAAM,sBAAsB,gBAAgB;AAAA,IACnD;AAAA,EACD;AACD,SAAO;AACR;AAEA,SAAS,YAAY,UAAU,YAAY,YAAY,aAAa;AACnE,QAAM,QAAQ,CAAE;AAChB,QAAM,OAAO,IAAI;AAAA,IAChB,OAAO;AAAA,MAAC;AAAA,QACN,UAAU;AAAA,QACV,cAAc,MAAM,OAAO;AAAA,MAC3B;AAAA,MACD;AAAA,QACC,kBAAkB,SAAS,MAAM,OAAO,MAAM,UAAU;AACvD,gBAAM,WAAW,SAAS,KAAK;AAC/B,cAAI,aAAa,MAAM;AACtB,qBAAS,QAAQ;AAAA,UACjB;AACD,iBAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAED,MAAI,WAAW;AACd,UAAM,SAAS,IAAI;AAAA,MAClB,OAAO;AAAA,QAAC;AAAA,UACN,UAAU;AAAA,UACV,cAAc,MAAM,OAAO;AAAA,QAC3B;AAAA,QACD;AAAA,UACC,kBAAkB,SAAS,MAAM,OAAO,MAAM,UAAU;AACvD,gBAAI,SAAS,KAAK,OAAO,GAAG;AAC3B,uBAAS,MAAM,OAAO,QAAQ;AAAA,YAC9B;AACD,mBAAO;AAAA,UACP;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,EACD;AACD,SAAO;AACR;AAEA,MAAe,cAAA;AAAA,EACd;AAAA,EACA;AAAA,EACA;AACD;;"}