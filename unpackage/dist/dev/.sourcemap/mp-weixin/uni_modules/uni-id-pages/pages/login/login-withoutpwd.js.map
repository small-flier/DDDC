{"version":3,"file":"login-withoutpwd.js","sources":["uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue","../../../../../HBuilderX.3.8.7.20230703/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXNcdW5pLWlkLXBhZ2VzXHBhZ2VzXGxvZ2luXGxvZ2luLXdpdGhvdXRwd2QudnVl"],"sourcesContent":["<!-- 免密登录页 -->\r\n<template>\r\n\t<view class=\"uni-content\">\r\n\t\t<view class=\"login-logo\">\r\n\t\t\t<image :src=\"logo\"></image>\r\n\t\t</view>\r\n\t\t<!-- 顶部文字 -->\r\n\t\t<text class=\"title\">请选择登录方式</text>\r\n\t\t<!-- 快捷登录框 当url带参数时有效 -->\r\n\t\t<template v-if=\"['apple','weixin', 'weixinMobile'].includes(type)\">\r\n\t\t\t<text class=\"tip\">将根据第三方账号服务平台的授权范围获取你的信息</text>\r\n\t\t\t<view class=\"quickLogin\">\r\n\t\t\t\t<image v-if=\"type !== 'weixinMobile'\" @click=\"quickLogin\" :src=\"imgSrc\" mode=\"widthFix\"\r\n\t\t\t\t\tclass=\"quickLoginBtn\"></image>\r\n\t\t\t\t<button v-else type=\"primary\" open-type=\"getPhoneNumber\" @getphonenumber=\"quickLogin\"\r\n\t\t\t\t\tclass=\"uni-btn\">微信授权手机号登录</button>\r\n\t\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t</view>\r\n\t\t</template>\r\n\t\t<template v-else>\r\n\t\t\t<text class=\"tip\">未注册的账号验证通过后将自动注册</text>\r\n\t\t\t<view class=\"phone-box\">\r\n\t\t\t\t<view @click=\"chooseArea\" class=\"area\">+86</view>\r\n\t\t\t\t<uni-easyinput trim=\"both\" :focus=\"focusPhone\" @blur=\"focusPhone = false\" class=\"input-box\" type=\"number\"\r\n\t\t\t\t\t:inputBorder=\"false\" v-model=\"phone\" maxlength=\"11\" placeholder=\"请输入手机号\" />\r\n\t\t\t</view>\r\n\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"toSmsPage\">获取验证码</button>\r\n\t\t</template>\r\n\t\t<!-- 固定定位的快捷登录按钮 -->\r\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tlet currentWebview; //当前窗口对象\r\n\timport config from '@/uni_modules/uni-id-pages/config.js'\r\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\r\n\texport default {\r\n\t\tmixins: [mixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"\", //快捷登录方式\r\n\t\t\t\tphone: \"\", //手机号码\r\n\t\t\t\tfocusPhone: false,\r\n\t\t\t\tlogo: \"/static/logo.png\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tasync loginTypes() { //读取配置的登录优先级\r\n\t\t\t\treturn config.loginTypes\r\n\t\t\t},\r\n\t\t\tisPhone() { //手机号码校验正则\r\n\t\t\t\treturn /^1\\d{10}$/.test(this.phone);\r\n\t\t\t},\r\n\t\t\timgSrc() { //大快捷登录按钮图\r\n\t\t\t\treturn this.type == 'weixin' ? '/uni_modules/uni-id-pages/static/login/weixin.png' :\r\n\t\t\t\t\t'/uni_modules/uni-id-pages/static/app-plus/apple.png'\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad(e) {\r\n\t\t\t//获取通过url传递的参数type设置当前登录方式，如果没传递直接默认以配置的登录\r\n\t\t\tlet type = e.type || config.loginTypes[0]\r\n\t\t\tthis.type = type\r\n\r\n\t\t\t// console.log(\"this.type: -----------\",this.type);\r\n\t\t\tif (type != 'univerify') {\r\n\t\t\t\tthis.focusPhone = true\r\n\t\t\t}\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t//关闭重复显示的登录快捷方式\r\n\t\t\t\tif (['weixin', 'apple'].includes(type)) {\r\n\t\t\t\t\tthis.$refs.uniFabLogin.servicesList = this.$refs.uniFabLogin.servicesList.filter(item =>\r\n\t\t\t\t\t\titem.id != type)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tuni.$on('uni-id-pages-setLoginType', type => {\r\n\t\t\t\tthis.type = type\r\n\t\t\t})\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// #ifdef H5\r\n\t\t\tdocument.onkeydown = event => {\r\n\t\t\t\tvar e = event || window.event;\r\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\r\n\t\t\t\t\tthis.toSmsPage()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('uni-id-pages-setLoginType')\r\n\t\t},\r\n\t\tonReady() {\r\n\t\t\t// 是否优先启动一键登录。即：页面一加载就启动一键登录\r\n\t\t\t//#ifdef APP-PLUS\r\n\t\t\tif (config.loginTypes.includes('univerify') && this.type == \"univerify\") {\r\n\t\t\t\tuni.preLogin({\r\n\t\t\t\t\tprovider: 'univerify',\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tconst pages = getCurrentPages();\r\n\t\t\t\t\t\tcurrentWebview = pages[pages.length - 1].$getAppWebview();\r\n\t\t\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\t\t\"top\": \"2000px\" // 隐藏当前页面窗体\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// this.type == this.loginTypes[1]\r\n\t\t\t\t\t\t// console.log('开始一键登录');\r\n\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before('univerify')\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tif (config.loginTypes.length > 1) {\r\n\t\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before(config.loginTypes[1])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t//#endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowCurrentWebview(){\r\n\t\t\t\t// 恢复当前页面窗体的显示 一键登录，默认不显示当前窗口\r\n\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\"top\": 0\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tquickLogin(e) {\r\n\t\t\t\tlet options = {}\r\n\r\n\t\t\t\tif (e.detail?.code) {\r\n\t\t\t\t\toptions.phoneNumberCode = e.detail.code\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.type === 'weixinMobile' && !e.detail?.code) return\r\n\r\n\t\t\t\tthis.$refs.uniFabLogin.login_before(this.type, true, options)\r\n\t\t\t},\r\n\t\t\ttoSmsPage() {\r\n\t\t\t\tif (!this.isPhone) {\r\n\t\t\t\t\tthis.focusPhone = true\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: \"手机号码格式不正确\",\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (this.needAgreements && !this.agree) {\r\n\t\t\t\t\treturn this.$refs.agreements.popup(this.toSmsPage)\r\n\t\t\t\t}\r\n\t\t\t\t// 发送验证吗\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-smscode?phoneNumber=' + this.phone\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//去密码登录页\r\n\t\t\ttoPwdLogin() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../login/password'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchooseArea() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '暂不支持其他国家',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 3000\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t@import \"@/uni_modules/uni-id-pages/common/login-page.scss\";\r\n\r\n\t@media screen and (min-width: 690px) {\r\n\t\t.uni-content {\r\n\t\t\theight: 350px;\r\n\t\t}\r\n\t}\r\n\r\n\t.uni-content,\r\n\t.quickLogin {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.phone-box {\r\n\t\tposition: relative;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.area {\r\n\t\tposition: absolute;\r\n\t\tleft: 10px;\r\n\t\tz-index: 9;\r\n\t\ttop: 12px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.area::after {\r\n\t\tcontent: \"\";\r\n\t\tborder: 3px solid transparent;\r\n\t\tborder-top-color: #000;\r\n\t\ttop: 12px;\r\n\t\tleft: 3px;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t/* #ifdef MP */\r\n\t// 解决小程序端开启虚拟节点virtualHost引起的 class = input-box丢失的问题 [详情参考](https://uniapp.dcloud.net.cn/matter.html#%E5%90%84%E5%AE%B6%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6%E4%B8%8D%E5%90%8C-%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E5%B9%B3%E5%8F%B0%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98)\r\n\t.phone-box ::v-deep .uni-easyinput__content,\r\n\t/* #endif */\r\n\t.input-box {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tbox-sizing: border-box;\r\n\t\t/* #endif */\r\n\t\tflex: 1;\r\n\t\tpadding-left: 45px;\r\n\t\tmargin-bottom: 10px;\r\n\t\tborder-radius: 0;\r\n\t}\r\n\r\n\t.quickLogin {\r\n\t\theight: 350px;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.quickLoginBtn {\r\n\t\tmargin: 20px 0;\r\n\t\twidth: 450rpx;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tmax-width: 230px;\r\n\t\t/* #endif */\r\n\t\theight: 82rpx;\r\n\t}\r\n\r\n\t.tip {\r\n\t\tmargin-top: -15px;\r\n\t\tmargin-bottom: 20px;\r\n\t}\r\n\r\n\t@media screen and (min-width: 690px) {\r\n\t\t.quickLogin {\r\n\t\t\theight: auto;\r\n\t\t}\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/93152/Desktop/转转转/DDDC/uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["mixin","config","uni","type"],"mappings":";;;;AAmCC,IAAI;AAGJ,MAAK,YAAU;AAAA,EACd,QAAQ,CAACA,8CAAAA,KAAK;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA;AAAA,MACN,OAAO;AAAA;AAAA,MACP,YAAY;AAAA,MACZ,MAAM;AAAA,IACP;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,MAAM,aAAa;AAClB,aAAOC,8BAAM,OAAC;AAAA,IACd;AAAA,IACD,UAAU;AACT,aAAO,YAAY,KAAK,KAAK,KAAK;AAAA,IAClC;AAAA,IACD,SAAS;AACR,aAAO,KAAK,QAAQ,WAAW,sDAC9B;AAAA,IACF;AAAA,EACA;AAAA,EACD,MAAM,OAAO,GAAG;AAEf,QAAI,OAAO,EAAE,QAAQA,8BAAAA,OAAO,WAAW,CAAC;AACxC,SAAK,OAAO;AAGZ,QAAI,QAAQ,aAAa;AACxB,WAAK,aAAa;AAAA,IACnB;AACA,SAAK,UAAU,MAAM;AAEpB,UAAI,CAAC,UAAU,OAAO,EAAE,SAAS,IAAI,GAAG;AACvC,aAAK,MAAM,YAAY,eAAe,KAAK,MAAM,YAAY,aAAa,OAAO,UAChF,KAAK,MAAM,IAAI;AAAA,MACjB;AAAA,KACA;AACDC,wBAAI,IAAI,6BAA6B,CAAAC,UAAQ;AAC5C,WAAK,OAAOA;AAAA,KACZ;AAAA,EACD;AAAA,EACD,SAAS;AAAA,EASR;AAAA,EACD,WAAW;AACVD,kBAAG,MAAC,KAAK,2BAA2B;AAAA,EACpC;AAAA,EACD,UAAU;AAAA,EA8BT;AAAA,EACD,SAAS;AAAA,IACR,qBAAoB;AAEnB,qBAAe,SAAS;AAAA,QACvB,OAAO;AAAA,OACP;AAAA,IACD;AAAA,IACD,WAAW,GAAG;;AACb,UAAI,UAAU,CAAC;AAEf,WAAI,OAAE,WAAF,mBAAU,MAAM;AACnB,gBAAQ,kBAAkB,EAAE,OAAO;AAAA,MACpC;AAEA,UAAI,KAAK,SAAS,kBAAkB,GAAC,OAAE,WAAF,mBAAU;AAAM;AAErD,WAAK,MAAM,YAAY,aAAa,KAAK,MAAM,MAAM,OAAO;AAAA,IAC5D;AAAA,IACD,YAAY;AACX,UAAI,CAAC,KAAK,SAAS;AAClB,aAAK,aAAa;AAClB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,UAAI,KAAK,kBAAkB,CAAC,KAAK,OAAO;AACvC,eAAO,KAAK,MAAM,WAAW,MAAM,KAAK,SAAS;AAAA,MAClD;AAEAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qEAAqE,KAAK;AAAA,MAChF,CAAC;AAAA,IACD;AAAA;AAAA,IAED,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACD;AAAA,IACD,aAAa;AACZA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,QACN,UAAU;AAAA,MACX,CAAC;AAAA,IACD;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5KD,GAAG,WAAW,eAAe;"}