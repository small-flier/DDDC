{"version":3,"file":"uni-sign-in.js","sources":["uni_modules/uni-sign-in/components/uni-sign-in/uni-sign-in.vue","../../../../../HBuilderX.3.8.7.20230703/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvOTMxNTIvRGVza3RvcC_ovazovazovawvREREQy91bmlfbW9kdWxlcy91bmktc2lnbi1pbi9jb21wb25lbnRzL3VuaS1zaWduLWluL3VuaS1zaWduLWluLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<uni-popup ref=\"popup\" type=\"center\">\r\n\t\t\t<image class=\"background-img\" src=\"@/uni_modules/uni-sign-in/static/background.png\" mode=\"width\">\r\n\t\t\t</image>\r\n\t\t\t<view class=\"content\">\r\n\t\t\t\t<view class=\"main\">\r\n\t\t\t\t\t<text class=\"title\">今日签到成功</text>\r\n\t\t\t\t\t<text class=\"total\">本轮已签到{{signInRes.days.length}}天</text>\r\n\t\t\t\t\t<text class=\"scores\">当前积分：{{signInRes.score}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<view class=\"days-box\">\r\n\t\t\t\t\t\t<view class=\"days\" v-for=\"(item,index) in weekdays\" :key=\"index\">\r\n\t\t\t\t\t\t\t<uni-icons v-if=\"signInRes.days.includes(item-1)\" class=\"icon active\" color=\"#FFFFFF\"\r\n\t\t\t\t\t\t\t\ttype=\"checkmarkempty\"></uni-icons>\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t<uni-icons v-if=\"item<signInRes.n\" class=\"icon active\" color=\"#FFFFFF\"\r\n\t\t\t\t\t\t\t\t\ttype=\"closeempty\"></uni-icons>\r\n\t\t\t\t\t\t\t\t<uni-icons v-else class=\"icon\" type=\"checkmarkempty\" color=\"#FFFFFF\"></uni-icons>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-if=\"signInRes.days.includes(item-1)||item>signInRes.n\">\r\n\t\t\t\t\t\t\t\t<text class=\"day\" :class=\"{grey:item>signInRes.n}\">第{{item}}天</text>\r\n\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t<text v-else class=\"day\">缺卡</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"tip-box\">\r\n\t\t\t\t\t\t<text class=\"tip\">签到一次得10积分</text>\r\n\t\t\t\t\t\t<view class=\"row\">\r\n\t\t\t\t\t\t\t<text class=\"tip\">连续签到7天可多得</text>\r\n\t\t\t\t\t\t\t<text class=\"red\">50</text>\r\n\t\t\t\t\t\t\t<text class=\"tip\">积分</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-icons @click=\"closeMe\" class=\"close-icon\" type=\"closeempty\" size=\"20\" color=\"#AAAAAA\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst db = uniCloud.database();\r\n\tconst signInTable = db.action('signIn').collection('opendb-sign-in')\r\n\tconst date = new Date(new Date().toLocaleDateString()).getTime()\r\n\timport AD from \"../../utils/ad.js\"\r\n\texport default {\r\n\t\tname: \"uni-signIn\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttotal: 0,\r\n\t\t\t\tscores: 0,\r\n\t\t\t\tweekdays: [1, 2, 3, 4, 5, 6, 7],\r\n\t\t\t\tsignInRes: {\r\n\t\t\t\t\tdays: [],\r\n\t\t\t\t\tn: 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {},\r\n\t\tmethods: {\r\n\t\t\tasync getSignedInInfo(ToastText = '今日已签过') {\r\n\t\t\t\tconst date = new Date(new Date().toLocaleDateString()).getTime()\r\n\t\t\t\tlet res = await signInTable\r\n\t\t\t\t\t.where(`'user_id' == $env.uid && 'date' == ${date} && 'isDelete' == false`)\r\n\t\t\t\t\t.get()\r\n\t\t\t\tif (res.result.data.length) {\r\n\t\t\t\t\tthis.signInRes = res.result\r\n\t\t\t\t\tthis.$refs.popup.open()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: ToastText,\r\n\t\t\t\t\t\tduration: 3000,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn res.result.data\r\n\t\t\t},\r\n\t\t\t//看激励视频广告签到\r\n\t\t\tasync showRewardedVideoAd() {\r\n\t\t\t\tlet res = await this.getSignedInInfo();\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tif (res && res.length == 0) {\r\n\t\t\t\t\tlet {\r\n\t\t\t\t\t\t_id: userId\r\n\t\t\t\t\t} = uni.getStorageSync('userInfo')\r\n\t\t\t\t\tconsole.log(userId, uni.getStorageSync('userInfo'));\r\n\t\t\t\t\tif (!userId) {\r\n\t\t\t\t\t\treturn uni.navigateTo({\r\n\t\t\t\t\t\t\turl: \"/pages/ucenter/login-page/index/index\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 调用后会显示 loading 界面\r\n\t\t\t\t\tAD.show({\r\n\t\t\t\t\t\tadpid: 1733738477, // HBuilder 基座测试广告位\r\n\t\t\t\t\t\tadType: \"RewardedVideo\",\r\n\t\t\t\t\t\turlCallback: {\r\n\t\t\t\t\t\t\tuserId,\r\n\t\t\t\t\t\t\textra: 'uniSignIn'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, res => {\r\n\t\t\t\t\t\t// 用户点击了【关闭广告】按钮\r\n\t\t\t\t\t\tif (res && res.isEnded) {\r\n\t\t\t\t\t\t\t// 正常播放结束\r\n\t\t\t\t\t\t\tconsole.log(\"onClose \" + res.isEnded);\r\n\t\t\t\t\t\t\t//3次轮训查结果\r\n\t\t\t\t\t\t\t// uni.showLoading({mask: true});\r\n\t\t\t\t\t\t\tlet i = 0;\r\n\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tlet myIntive = setInterval(async e => {\r\n\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t\tres = await this.getSignedInInfo('签到成功');\r\n\t\t\t\t\t\t\t\tif (i > 2 || res.length) {\r\n\t\t\t\t\t\t\t\t\tif (!res.length) {\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '签到失败！',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\t\t\t\t\t\t\tduration: 6000\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tclearInterval(myIntive)\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 播放中途退出\r\n\t\t\t\t\t\t\tconsole.log(\"onClose \" + res.isEnded);\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '播放中途退出,签到失败！',\r\n\t\t\t\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 在此处理服务器回调逻辑\r\n\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\t// 广告加载错误\r\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: err.errMsg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//普通点击签到\r\n\t\t\tasync open() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet res = await this.getSignedInInfo();\r\n\t\t\t\t\tif (res && res.length == 0) {\r\n\t\t\t\t\t\tlet res = await signInTable.add({});\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\tthis.signInRes = res.result\r\n\t\t\t\t\t\tthis.$refs.popup.open()\r\n\t\t\t\t\t\tif (this.signInRes.days.length == 7) {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"你已完成7日连续签到，获得60积分！\",\r\n\t\t\t\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"签到成功,获得10积分！\",\r\n\t\t\t\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcloseMe(e) {\r\n\t\t\t\tthis.$refs.popup.close()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\tview {\r\n\t\tdisplay: flex;\r\n\t\tbox-sizing: border-box;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\tscroll-view {\r\n\t\t-webkit-overflow-scrolling: touch;\r\n\t}\r\n\r\n\t.background-img {\r\n\t\twidth: 600rpx;\r\n\t\theight: 600rpx;\r\n\t}\r\n\r\n\t.content {\r\n\t\tposition: absolute;\r\n\t\twidth: 600rpx;\r\n\t\theight: 600rpx;\r\n\t\tjustify-content: space-around;\r\n\t\talign-items: center;\r\n\t\tborder-radius: 10px;\r\n\t\tz-index: 5;\r\n\t}\r\n\r\n\t.background-img,\r\n\t.content {\r\n\t\ttop: 0;\r\n\t}\r\n\r\n\t.main {\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 44rpx;\r\n\t\tcolor: #FFFFFF;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.total {\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tcolor: #ed5200;\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 100px;\r\n\t\tfont-size: 30rpx;\r\n\t\tmargin: 16rpx 0;\r\n\t\twidth: 230rpx;\r\n\t}\r\n\r\n\t.scores {\r\n\t\ttext-align: center;\r\n\t\tcolor: #FFFFFF;\r\n\t}\r\n\r\n\t.days-box {\r\n\t\tflex-direction: row;\r\n\t}\r\n\r\n\t.days {\r\n\t\tmargin: 12rpx;\r\n\t\tfont-size: 19rpx;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tcolor: #f8692c;\r\n\t}\r\n\r\n\t.grey {\r\n\t\tcolor: #C0C0C0;\r\n\t}\r\n\r\n\t.days-box .icon {\r\n\t\tbackground-color: #feefeb;\r\n\t\tborder-radius: 100px;\r\n\t\theight: 50rpx;\r\n\t\tline-height: 50rpx;\r\n\t\ttext-align: center;\r\n\t\twidth: 50rpx;\r\n\t\tmargin-bottom: 6rpx;\r\n\t}\r\n\r\n\t.days-box .icon.active {\r\n\t\tbackground-image: linear-gradient(to top, #FF9002, #FF5100);\r\n\t\tbackground-color: #ffff7f;\r\n\t}\r\n\r\n\t.content,\r\n\t.days-box {\r\n\t\tpadding: 26rpx;\r\n\t}\r\n\r\n\t.tip-box {\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.tip-box .row {\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.tip,\r\n\t.red {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999999;\r\n\t\theight: 30rpx;\r\n\t\tline-height: 30rpx;\r\n\t}\r\n\r\n\t.red {\r\n\t\tcolor: #ff0000;\r\n\t}\r\n\r\n\t.close-icon {\r\n\t\tmargin-bottom: -180rpx;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 100px;\r\n\t\ttext-align: center;\r\n\t\theight: 46rpx;\r\n\t\tline-height: 46rpx;\r\n\t\twidth: 46rpx;\r\n\t}\r\n</style>\n","import Component from 'C:/Users/93152/Desktop/转转转/DDDC/uni_modules/uni-sign-in/components/uni-sign-in/uni-sign-in.vue'\nwx.createComponent(Component)"],"names":["uniCloud","uni","AD","res"],"mappings":";;;;AA4CC,MAAM,KAAKA,cAAAA,GAAS;AACpB,MAAM,cAAc,GAAG,OAAO,QAAQ,EAAE,WAAW,gBAAgB;AACtD,IAAI,MAAK,oBAAI,KAAI,GAAG,mBAAoB,CAAA,EAAE,QAAQ;AAE/D,MAAK,YAAU;AAAA,EACd,MAAM;AAAA,EACN,OAAO;AACN,WAAO;AAAA,MACN,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,UAAU,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,MAC9B,WAAW;AAAA,QACV,MAAM,CAAE;AAAA,QACR,GAAG;AAAA,MACJ;AAAA,IACD;AAAA,EACA;AAAA,EACD,UAAU;AAAA,EAAE;AAAA,EACZ,SAAS;AAAA,IACR,MAAM,gBAAgB,YAAY,SAAS;AAC1C,YAAM,OAAO,IAAI,MAAK,oBAAI,KAAI,GAAG,mBAAkB,CAAE,EAAE,QAAQ;AAC/D,UAAI,MAAM,MAAM,YACd,MAAM,sCAAsC,IAAI,yBAAyB,EACzE,IAAI;AACN,UAAI,IAAI,OAAO,KAAK,QAAQ;AAC3B,aAAK,YAAY,IAAI;AACrB,aAAK,MAAM,MAAM,KAAK;AACtBC,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,UAAU;AAAA,UACV,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AACA,aAAO,IAAI,OAAO;AAAA,IAClB;AAAA;AAAA,IAED,MAAM,sBAAsB;AAC3B,UAAI,MAAM,MAAM,KAAK;AACrBA,oBAAAA,MAAA,MAAA,OAAA,wEAAY,GAAG;AACf,UAAI,OAAO,IAAI,UAAU,GAAG;AAC3B,YAAI;AAAA,UACH,KAAK;AAAA,QACN,IAAIA,cAAG,MAAC,eAAe,UAAU;AACjCA,iHAAY,QAAQA,oBAAI,eAAe,UAAU,CAAC;AAClD,YAAI,CAAC,QAAQ;AACZ,iBAAOA,cAAAA,MAAI,WAAW;AAAA,YACrB,KAAK;AAAA,WACL;AAAA,QACF;AAEAC,uCAAAA,GAAG,KAAK;AAAA,UACP,OAAO;AAAA;AAAA,UACP,QAAQ;AAAA,UACR,aAAa;AAAA,YACZ;AAAA,YACA,OAAO;AAAA,UACR;AAAA,QACA,GAAE,CAAAC,SAAO;AAET,cAAIA,QAAOA,KAAI,SAAS;AAEvBF,0BAAA,MAAA,MAAA,OAAA,yEAAY,aAAaE,KAAI,OAAO;AAGpC,gBAAI,IAAI;AACRF,0BAAAA,MAAI,YAAY;AAAA,cACf,MAAM;AAAA,aACN;AACD,gBAAI,WAAW,YAAY,OAAM,MAAK;AACrC;AACA,cAAAE,OAAM,MAAM,KAAK,gBAAgB,MAAM;AACvC,kBAAI,IAAI,KAAKA,KAAI,QAAQ;AACxB,oBAAI,CAACA,KAAI,QAAQ;AAChBF,gCAAAA,MAAI,UAAU;AAAA,oBACb,OAAO;AAAA,oBACP,MAAM;AAAA,oBACN,UAAU;AAAA,kBACX,CAAC;AAAA,gBACF;AACA,8BAAc,QAAQ;AACtBA,8BAAAA,MAAI,YAAY;AAAA,cACjB;AAAA,YACA,GAAE,GAAI;AAAA,iBACD;AAENA,0BAAA,MAAA,MAAA,OAAA,yEAAY,aAAaE,KAAI,OAAO;AACpCF,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,cACN,UAAU;AAAA,YACX,CAAC;AAAA,UACF;AAAA,QAEA,GAAE,CAAC,QAAQ;AAEXA,wBAAAA,MAAY,MAAA,OAAA,yEAAA,GAAG;AACfA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI;AAAA,YACX,MAAM;AAAA,UACP,CAAC;AAAA,SACD;AAAA,MACF;AAAA,IACA;AAAA;AAAA,IAED,MAAM,OAAO;AACZA,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,MACP,CAAC;AACD,UAAI;AACH,YAAI,MAAM,MAAM,KAAK;AACrB,YAAI,OAAO,IAAI,UAAU,GAAG;AAC3B,cAAIE,OAAM,MAAM,YAAY,IAAI,CAAE,CAAA;AAClCF,wBAAAA,MAAY,MAAA,OAAA,yEAAAE,IAAG;AACfF,wBAAAA,MAAI,YAAY;AAChB,eAAK,YAAYE,KAAI;AACrB,eAAK,MAAM,MAAM,KAAK;AACtB,cAAI,KAAK,UAAU,KAAK,UAAU,GAAG;AACpCF,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,cACN,UAAU;AAAA,aACV;AAAA,iBACK;AACNA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,cACN,UAAU;AAAA,aACV;AAAA,UACF;AAAA,QACD;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAI,YAAY;AAChBA,sBAAAA,MAAc,MAAA,SAAA,yEAAA,CAAC;AAAA,MAChB;AAAA,IACA;AAAA,IACD,QAAQ,GAAG;AACV,WAAK,MAAM,MAAM,MAAM;AAAA,IACxB;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtLD,GAAG,gBAAgB,SAAS;"}