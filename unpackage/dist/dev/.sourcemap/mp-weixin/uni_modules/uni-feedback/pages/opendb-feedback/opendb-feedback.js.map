{"version":3,"file":"opendb-feedback.js","sources":["uni_modules/uni-feedback/pages/opendb-feedback/opendb-feedback.vue","../../../../../HBuilderX.3.8.7.20230703/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXNcdW5pLWZlZWRiYWNrXHBhZ2VzXG9wZW5kYi1mZWVkYmFja1xvcGVuZGItZmVlZGJhY2sudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"uni-container\">\r\n\t\t<uni-forms ref=\"form\" :value=\"formData\" validate-trigger=\"submit\" err-show-type=\"toast\">\r\n\t\t\t<uni-forms-item name=\"content\" label=\"留言内容/回复内容\" required>\r\n\t\t\t\t<textarea @input=\"binddata('content', $event.detail.value)\" class=\"uni-textarea-border\"\r\n\t\t\t\t\tv-model=\"formData.content\" trim=\"right\"></textarea>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"imgs\" label=\"图片列表\">\r\n\t\t\t\t<uni-file-picker file-mediatype=\"image\" :limit=\"6\" return-type=\"array\" v-model=\"formData.imgs\">\r\n\t\t\t\t</uni-file-picker>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"contact\" label=\"联系人\">\r\n\t\t\t\t<uni-easyinput v-model=\"formData.contact\" trim=\"both\"></uni-easyinput>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"mobile\" label=\"联系电话\">\r\n\t\t\t\t<uni-easyinput v-model=\"formData.mobile\" trim=\"both\"></uni-easyinput>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<view class=\"uni-button-group\">\r\n\t\t\t\t<button type=\"primary\" class=\"uni-button\" @click=\"submit\">提交</button>\r\n\t\t\t</view>\r\n\t\t</uni-forms>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tvalidator\r\n\t} from '../../js_sdk/validator/opendb-feedback.js';\r\n\tconsole.log(validator);\r\n\tconst db = uniCloud.database();\r\n\tconst dbCollectionName = 'opendb-feedback';\r\n\r\n\tfunction getValidator(fields) {\r\n\t\tlet result = {}\r\n\t\tfor (let key in validator) {\r\n\t\t\tif (fields.indexOf(key) > -1) {\r\n\t\t\t\tresult[key] = validator[key]\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tlet formData = {\r\n\t\t\t\t\"content\": \"\",\r\n\t\t\t\t\"imgs\": [],\r\n\t\t\t\t\"contact\": \"\",\r\n\t\t\t\t\"mobile\": \"\"\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tformData,\r\n\t\t\t\tformOptions: {},\r\n\t\t\t\trules: {\r\n\t\t\t\t\t...getValidator(Object.keys(formData))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonReady() {\r\n\t\t\tthis.$refs.form.setRules(this.rules)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 触发表单提交\r\n\t\t\t */\r\n\t\t\tsubmit() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\tthis.$refs.form.validate().then((res) => {\r\n\t\t\t\t\tthis.submitForm(res)\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tsubmitForm(value) {\r\n\t\t\t\t// 使用 clientDB 提交数据\r\n\t\t\t\tdb.collection(dbCollectionName).add(value).then((res) => {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\ttitle: '提交成功'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.getOpenerEventChannel().emit('refreshData')\r\n\t\t\t\t\tsetTimeout(() => uni.navigateBack(), 500)\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: err.message || '请求服务失败',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.uni-container {\r\n\t\tpadding: 15px;\r\n\t}\r\n\r\n\t.uni-input-border,\r\n\t.uni-textarea-border {\r\n\t\twidth: 100%;\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t\tborder: 1px #e5e5e5 solid;\r\n\t\tborder-radius: 5px;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.uni-input-border {\r\n\t\tpadding: 0 10px;\r\n\t\theight: 35px;\r\n\r\n\t}\r\n\r\n\t.uni-textarea-border {\r\n\t\tpadding: 10px;\r\n\t\theight: 80px;\r\n\t}\r\n\r\n\t.uni-button-group {\r\n\t\tmargin-top: 50px;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.uni-button {\r\n\t\twidth: 184px;\r\n\t\tpadding: 12px 20px;\r\n\t\tfont-size: 14px;\r\n\t\tborder-radius: 4px;\r\n\t\tline-height: 1;\r\n\t\tmargin: 0;\r\n\t}\r\n</style>\n","import MiniProgramPage from 'C:/Users/93152/Desktop/转转转/DDDC/uni_modules/uni-feedback/pages/opendb-feedback/opendb-feedback.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","validator","uniCloud"],"mappings":";;;AA4BCA,cAAY,MAAA,MAAA,OAAA,4EAAAC,wDAAS,SAAA;AACrB,MAAM,KAAKC,iBAAS;AACpB,MAAM,mBAAmB;AAEzB,SAAS,aAAa,QAAQ;AAC7B,MAAI,SAAS,CAAC;AACd,WAAS,OAAOD,mEAAW;AAC1B,QAAI,OAAO,QAAQ,GAAG,IAAI,IAAI;AAC7B,aAAO,GAAG,IAAIA,wDAAS,UAAC,GAAG;AAAA,IAC5B;AAAA,EACD;AACA,SAAO;AACR;AAEA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,QAAI,WAAW;AAAA,MACd,WAAW;AAAA,MACX,QAAQ,CAAE;AAAA,MACV,WAAW;AAAA,MACX,UAAU;AAAA,IACX;AACA,WAAO;AAAA,MACN;AAAA,MACA,aAAa,CAAE;AAAA,MACf,OAAO;AAAA,QACN,GAAG,aAAa,OAAO,KAAK,QAAQ,CAAC;AAAA,MACtC;AAAA,IACD;AAAA,EACA;AAAA,EACD,UAAU;AACT,SAAK,MAAM,KAAK,SAAS,KAAK,KAAK;AAAA,EACnC;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,SAAS;AACRD,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,OACN;AACD,WAAK,MAAM,KAAK,SAAQ,EAAG,KAAK,CAAC,QAAQ;AACxC,aAAK,WAAW,GAAG;AAAA,OACnB,EAAE,MAAM,MAAM;AACdA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACD;AAAA,IAED,WAAW,OAAO;AAEjB,SAAG,WAAW,gBAAgB,EAAE,IAAI,KAAK,EAAE,KAAK,CAAC,QAAQ;AACxDA,sBAAAA,MAAI,UAAU;AAAA,UACb,MAAM;AAAA,UACN,OAAO;AAAA,SACP;AACD,aAAK,sBAAqB,EAAG,KAAK,aAAa;AAC/C,mBAAW,MAAMA,cAAAA,MAAI,aAAY,GAAI,GAAG;AAAA,MACzC,CAAC,EAAE,MAAM,CAAC,QAAQ;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACb,SAAS,IAAI,WAAW;AAAA,UACxB,YAAY;AAAA,SACZ;AAAA,MACF,CAAC,EAAE,QAAQ,MAAM;AAChBA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9FD,GAAG,WAAW,eAAe;"}