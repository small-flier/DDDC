{"version":3,"file":"opendb-feedback.js","sources":["uni_modules/uni-feedback/js_sdk/validator/opendb-feedback.js"],"sourcesContent":["// 表单校验规则由 schema2code 生成，不建议直接修改校验规则，而建议通过 schema2code 生成, 详情: https://uniapp.dcloud.net.cn/uniCloud/schema\r\n\r\n\r\nconst validator = {\r\n  \"content\": {\r\n    \"rules\": [\r\n      {\r\n        \"required\": true\r\n      },\r\n      {\r\n        \"format\": \"string\"\r\n      }\r\n    ],\r\n    \"label\": \"留言内容/回复内容\"\r\n  },\r\n  \"imgs\": {\r\n    \"rules\": [\r\n      {\r\n        \"format\": \"array\"\r\n      },\r\n      {\r\n        \"arrayType\": \"file\"\r\n      },\r\n      {\r\n        \"maxLength\": 6\r\n      }\r\n    ],\r\n    \"label\": \"图片列表\"\r\n  },\r\n  \"contact\": {\r\n    \"rules\": [\r\n      {\r\n        \"format\": \"string\"\r\n      }\r\n    ],\r\n    \"label\": \"联系人\"\r\n  },\r\n  \"mobile\": {\r\n    \"rules\": [\r\n      {\r\n        \"format\": \"string\"\r\n      },\r\n      {\r\n        \"pattern\": \"^\\\\+?[0-9-]{3,20}$\"\r\n      }\r\n    ],\r\n    \"label\": \"联系电话\"\r\n  }\r\n}\r\n\r\nconst enumConverter = {}\r\n\r\nfunction filterToWhere(filter, command) {\r\n  let where = {}\r\n  for (let field in filter) {\r\n    let { type, value } = filter[field]\r\n    switch (type) {\r\n      case \"search\":\r\n        if (typeof value === 'string' && value.length) {\r\n          where[field] = new RegExp(value)\r\n        }\r\n        break;\r\n      case \"select\":\r\n        if (value.length) {\r\n          let selectValue = []\r\n          for (let s of value) {\r\n            selectValue.push(command.eq(s))\r\n          }\r\n          where[field] = command.or(selectValue)\r\n        }\r\n        break;\r\n      case \"range\":\r\n        if (value.length) {\r\n          let gt = value[0]\r\n          let lt = value[1]\r\n          where[field] = command.and([command.gte(gt), command.lte(lt)])\r\n        }\r\n        break;\r\n      case \"date\":\r\n        if (value.length) {\r\n          let [s, e] = value\r\n          let startDate = new Date(s)\r\n          let endDate = new Date(e)\r\n          where[field] = command.and([command.gte(startDate), command.lte(endDate)])\r\n        }\r\n        break;\r\n      case \"timestamp\":\r\n        if (value.length) {\r\n          let [startDate, endDate] = value\r\n          where[field] = command.and([command.gte(startDate), command.lte(endDate)])\r\n        }\r\n        break;\r\n    }\r\n  }\r\n  return where\r\n}\r\n\r\nexport { validator, enumConverter, filterToWhere }\r\n"],"names":[],"mappings":";AAGK,MAAC,YAAY;AAAA,EAChB,WAAW;AAAA,IACT,SAAS;AAAA,MACP;AAAA,QACE,YAAY;AAAA,MACb;AAAA,MACD;AAAA,QACE,UAAU;AAAA,MACX;AAAA,IACF;AAAA,IACD,SAAS;AAAA,EACV;AAAA,EACD,QAAQ;AAAA,IACN,SAAS;AAAA,MACP;AAAA,QACE,UAAU;AAAA,MACX;AAAA,MACD;AAAA,QACE,aAAa;AAAA,MACd;AAAA,MACD;AAAA,QACE,aAAa;AAAA,MACd;AAAA,IACF;AAAA,IACD,SAAS;AAAA,EACV;AAAA,EACD,WAAW;AAAA,IACT,SAAS;AAAA,MACP;AAAA,QACE,UAAU;AAAA,MACX;AAAA,IACF;AAAA,IACD,SAAS;AAAA,EACV;AAAA,EACD,UAAU;AAAA,IACR,SAAS;AAAA,MACP;AAAA,QACE,UAAU;AAAA,MACX;AAAA,MACD;AAAA,QACE,WAAW;AAAA,MACZ;AAAA,IACF;AAAA,IACD,SAAS;AAAA,EACV;AACH;;"}